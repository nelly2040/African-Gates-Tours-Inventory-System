"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6793],{6793:function(e,n,t){t.d(n,{DZ:function(){return getValidatedRedirectUrlFromQueryParams},Dl:function(){return redirectToLoginPageForSocialSignupAttemptMissingBirthday},Ho:function(){return redirectToLoginPageForSocialSignupAttemptMissingEmail},PW:function(){return redirectToDesktopAppLoggedOutPage},SN:function(){return setRedirectUrlQueryParamForCurrentUrl},Sh:function(){return useOnLoginSuccess},W3:function(){return getDefaultGoogleSignupLoginErrorMessage},X0:function(){return redirectToLoginPage},_q:function(){return redirectToLoginPageForSocialSignupAttemptMissingAgreements},b8:function(){return redirectToLoggedInHomePage},bl:function(){return o},dh:function(){return removeRedirectUrlQueryParamFromCurrentUrl},gA:function(){return getRedirectUrlFromSignupLoginResponse},gS:function(){return getDefaultUserVerificationErrorMessage},gW:function(){return getDesktopAppOpenPageUrl},gf:function(){return useHandleGoogleSignupLoginMutationStatusForGoogleOneTap},h2:function(){return hasUserStartedSignupFlow},kz:function(){return shouldShowSubscriptionWall},lI:function(){return showSubscriptionWallAfterSignup},n$:function(){return a},o1:function(){return maybeGetRedirectUrl},q2:function(){return U},yn:function(){return getDefaultLoginErrorMessage}});var i,r,o,a,u=t(19692),s=t(11163),d=t(67294),l=t(22120),c=t(45549),_=t(90289),g=t(19029),p=t(66795),m=t(53533),f=t(46857),S=t(67275),h=t(90578),b=t(50530),y=t(30032),w=t(11747),k=t(60421);let getDefaultUserVerificationErrorMessage=e=>e("Something went wrong. Please wait a moment and try again."),getDefaultLoginErrorMessage=e=>e("An error occurred, please try again."),v="missing_email",P="signup_method",A="redirect_url",R="show_subscription_wall",redirectToLoginPageForSocialSignupAttemptMissingBirthday=(e,n,t)=>{redirectToLoginPage(e,t,{missing_birthday:"1",[P]:n})},redirectToLoginPageForSocialSignupAttemptMissingAgreements=(e,n,t,i)=>{redirectToLoginPage(e,t,{...i||{},missing_agreements:"1",[P]:n})},hasUserStartedSignupFlow=e=>{let{isLoginPage:n,queryParams:t}=e;return n&&("1"===t[v]||!!t[P])},redirectToLoginPageForSocialSignupAttemptMissingEmail=(e,n)=>{redirectToLoginPage(e,n,{[v]:"1"})},shouldShowSubscriptionWall=e=>"true"===e[R],showSubscriptionWallAfterSignup=e=>{setRedirectUrlQueryParamForCurrentUrl(e,"/?".concat(R,"=true"))},redirectToLoginPage=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.replace({pathname:"/login",query:{...t,[A]:null!=n?n:"/"}})},redirectToDesktopAppOpenPage=(e,n)=>{let t=getDesktopAppOpenPageUrl(n);e.replace(t)},redirectToDesktopAppLoggedOutPage=e=>e.replace("/desktop_app_logged_out"),maybeGetDesktopAppLoginRequestCode=e=>{let n=e.query.desktop_app_login_request_code;if((0,b.H)(n)&&n.length>0)return n},getValidatedRedirectUrlFromQueryParams=e=>{let n=e[A];if(n&&isValidRedirectUrl(String(n)))return String(n)},setRedirectUrlQueryParamForCurrentUrl=(e,n)=>{e.replace({query:{...e.query,[A]:isValidRedirectUrl(n)?n:void 0}})},removeRedirectUrlQueryParamFromCurrentUrl=e=>{let n={...e.query};delete n[A],e.replace({query:n})},getDesktopAppOpenPageUrl=e=>"/desktop_app_open?desktop_app_login_request_code=".concat(encodeURIComponent(e)),redirectToLoggedInHomePage=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.replace(n?"/?".concat("login_success","=1"):"/")},maybeGetRedirectUrl=e=>{let n=getValidatedRedirectUrlFromQueryParams(e.query);if(n)return n},getRedirectUrlFromSignupLoginResponse=e=>{let{redirectChatCode:n,redirectUrl:t}=e;if(n)return"/chat/".concat(n);if(t){let e=t.split("?")[1];if(e){let n=new URLSearchParams(e).get(A);if(n&&isValidRedirectUrl(n))return n}}if(t&&isValidRedirectUrl(t))return t},isValidRedirectUrl=e=>e&&e.length>0&&e.startsWith("/")&&!e.includes(":"),useOnLoginSuccess=()=>{let{t:e}=(0,l.$G)(),n=(0,s.useRouter)(),t=(0,S.AO)(),i=(0,c.ZP)(),r=(0,p.q)(),o=(0,d.useCallback)(n=>i({content:n?e("You have successfully signed up"):e("You have successfully logged in"),type:c.pC.success}),[i,e]);return(0,d.useCallback)(async e=>{let{isSignUp:i,isEligibleForRedirectToLoggedInHomePage:a=!0,showLoginSuccessToastAfterRedirectingToDifferentPage:s=!1,redirectUrl:d=maybeGetRedirectUrl(n),loginRequestCode:l=maybeGetDesktopAppLoginRequestCode(n),googleTagManagerEnhancedConversionProperties:c="{}"}=e;if(i){await (0,f.hP)("sng_complete_registration");let e=JSON.parse(c);(0,u.sendGTMEvent)({event:w.Z.CompleteRegistration,...e})}else await (0,f.hP)("sng_login");if((null==d?void 0:d.startsWith("/chat/"))||(await (0,m.sr)(),await (0,h.FV)()),l){o(!1),redirectToDesktopAppOpenPage(n,l);return}r(),d&&isValidRedirectUrl(d)?((d===n.asPath||s)&&o(i),n.replace(d)):a?redirectToLoggedInHomePage(n,s):o(i),(0,_.E)(),t(!0)},[n,t,r,o])},getDefaultGoogleSignupLoginErrorMessage=e=>e("Failed to complete Google login. Please wait a moment and try again."),useHandleGoogleSignupLoginMutationStatusForGoogleOneTap=()=>{let e=useOnLoginSuccess(),n=(0,c.ZP)(),t=(0,s.useRouter)(),{t:i}=(0,l.$G)(),r=getDefaultGoogleSignupLoginErrorMessage(i);return(0,d.useCallback)(i=>{let{status:o,redirectUrl:a,errorMessage:u,errorRedirectUrl:s,showLoginSuccessToastAfterRedirectingToDifferentPage:d,googleTagManagerEnhancedConversionProperties:l="{}"}=i;o===y.Z.success||o===y.Z.success_signup?e({isSignUp:o===y.Z.success_signup,redirectUrl:a,showLoginSuccessToastAfterRedirectingToDifferentPage:d,googleTagManagerEnhancedConversionProperties:l}):o===y.Z.birthday_not_found?redirectToLoginPageForSocialSignupAttemptMissingBirthday(t,k.Z.google,a):o===y.Z.agreement_acceptance_incomplete?redirectToLoginPageForSocialSignupAttemptMissingAgreements(t,k.Z.google,a):(n({content:null!=u?u:r,type:c.pC.error}),u&&(0,g.Z)("poe/signup_login_client_side_error",{status:o,signup_method:k.Z.google}),s&&t.replace({pathname:s}))},[r,e,t,n])};(i=o||(o={}))[i.loginStarted=1]="loginStarted",i[i.signupStarted=2]="signupStarted",i[i.signupContinued=3]="signupContinued",i[i.signupContinuedCodeSent=4]="signupContinuedCodeSent",i[i.signupContinuedBirthdayRequired=5]="signupContinuedBirthdayRequired",i[i.signupContinuedAgreementAcceptanceRequired=6]="signupContinuedAgreementAcceptanceRequired",(r=a||(a={}))[r.emailAddress=0]="emailAddress",r[r.phoneNumber=1]="phoneNumber";let U=/^[0-9]{6,}$/i},46857:function(e,n,t){let i;t.d(n,{Rz:function(){return useInitSingular},h0:function(){return getSingularDeviceId},hP:function(){return singularEvent}});var r=t(67294);let o="quora_b_46ba1291c98480d9dde6fed2b16c7cae__90053357",a="aff4cbc69cc3fee7a3b851fb6c40fed3",u="com.poe",initSingular=async()=>{await loadAndInitSingularSdk()},useInitSingular=()=>{(0,r.useEffect)(()=>{initSingular()},[])},loadAndInitSingularSdk=async()=>(i||(i=_loadAndInitSingularSdk()),await i),_loadAndInitSingularSdk=async()=>{let e=await t.e(8961).then(t.t.bind(t,58961,23)),{singularSdk:n,SingularConfig:i}=e;return await new Promise(e=>{if(n&&i&&o&&a&&u){let t=new i(o,a,u);t.withInitFinishedCallback(()=>e()),n.init(t)}}),e},singularEvent=async e=>{let n=await loadAndInitSingularSdk();return n.singularSdk.event(e)},getSingularDeviceId=async()=>{let e=await loadAndInitSingularSdk();return e.singularSdk.getSingularDeviceId()}},30032:function(e,n){var t,i;(i=t||(t={})).success="success",i.success_signup="success_signup",i.bad_actor="bad_actor",i.rate_limit_exceeded_ip="rate_limit_exceeded_ip",i.suspicious_name_email="suspicious_name_email",i.no_external_account_info="no_external_account_info",i.rate_limit_exceeded_browser_id="rate_limit_exceeded_browser_id",i.banned_browser_id="banned_browser_id",i.other="other",i.email_unconfirmed="email_unconfirmed",i.email_not_found="email_not_found",i.bad_email="bad_email",i.bad_name="bad_name",i.bad_password="bad_password",i.too_many_attempts="too_many_attempts",i.banned_user="banned_user",i.incorrect_password="incorrect_password",i.two_factor_authentication="two_factor_authentication",i.password_leaked="password_leaked",i.force_password_reset="force_password_reset",i.account_delete="account_delete",i.invalid_token="invalid_token",i.blocked_ip="blocked_ip",i.bad_token="bad_token",i.missing_fb_info="missing_fb_info",i.obfuscated_email="obfuscated_email",i.failed_captcha="failed_captcha",i.already_logged_in="already_logged_in",i.account_already_exists="account_already_exists",i.invite_code_needed="invite_code_needed",i.password_needed="password_needed",i.no_google_name="no_google_name",i.unconfirmed_account_exists="unconfirmed_account_exists",i.bad_authentication_token="bad_authentication_token",i.invalid_google_data="invalid_google_data",i.no_email="no_email",i.refused="refused",i.failed="failed",i.invalid_verification_code="invalid_verification_code",i.user_with_confirmed_email_not_found="user_with_confirmed_email_not_found",i.user_with_confirmed_phone_number_not_found="user_with_confirmed_phone_number_not_found",i.recently_verified_phone_number_not_found="recently_verified_phone_number_not_found",i.recently_verified_email_not_found="recently_verified_email_not_found",i.rate_limit_exceeded_default="rate_limit_exceeded_default",i.no_verification_in_progress="no_verification_in_progress",i.birthday_not_found="birthday_not_found",i.user_not_old_enough_to_signup="user_not_old_enough_to_signup",i.invalid_birthday="invalid_birthday",i.too_many_user_not_old_enough_to_signup_errors_recently="too_many_user_not_old_enough_to_signup_errors_recently",i.agreement_acceptance_incomplete="agreement_acceptance_incomplete",i.invalid_desktop_app_login_request_code="invalid_desktop_app_login_request_code",i.invalid_desktop_app_auth_token="invalid_desktop_app_auth_token",n.Z=t},11747:function(e,n){var t,i;(i=t||(t={})).CompleteRegistration="CompleteRegistration",i.Subscribe="Subscribe",i.MonthlySubscribe="MonthlySubscribe",i.YearlySubscribe="YearlySubscribe",n.Z=t},60421:function(e,n){var t,i;(i=t||(t={})).google="google",i.facebook="facebook",i.twitter="twitter",i.email="email",i.apple="apple",i.quora="quora",n.Z=t}}]);